<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Patients Management</title>

        <style>
            body{
                font-family:Georgia, 'Times New Roman', Times, serif;
                background: #d3dbe7;
                margin:0;
                padding: 0;
            }

            header{
                background: #75c7e5;
                padding: 20px;
                text-align: center;
                color:#245a6d;
                font-size: 24px;
                font-weight: bold;
                margin-top:1%;
            }
            .welcome {
                font-size:15px;
                color:#2a6ac7;
                background: white;
                padding: 10px;
                border-radius: 30px;
                text-align: center;
                width: 40%;
                margin: 20px;
                border-color: #2a6ac7;

            }
            .container {
                display: flex;
                justify-content: center;
                gap: 5px;             
                margin-top: 20px;
                align-items: flex-start;   /* ‚Üê THIS fixes the tall empty box */

            }
            



        </style>
    </head>
    <body>
        <a href="http://localhost:3000/dashboard">Back to Dashboard</a>
        <header>Patient Management</header>

        <!-- Add Patient Form -->
    <div class="container">
        
        <form class="welcome" action="/add_patient" method="post">
            <h2>Add Patient</h2>

            <label for="first_name">First Name:</label><br>
            <input type="text" id="first_name" name="first_name" required><br><br>

            <label for="last_name">Last Name:</label><br>
            <input type="text" id="last_name" name="last_name"><br><br>

            <label for="date_of_birth">Date of Birth:</label><br>
            <input type="date" id="date_of_birth" name="date_of_birth" required><br><br>

            <label for="gender">Gender:</label><br>
            <select id="gender" name="gender">
                <option value="Male">Male</option>
                <option value="Female">Female</option>
                <option value="Other">Other</option>
            </select><br><br>

            <label for="phone_number">Phone Number:</label><br>
            <input type="text" id="phone_number" name="phone_number"><br><br>

            <label for="email">Email:</label><br>
            <input type="email" id="email" name="email"><br><br>

            <label for="address">Address:</label><br>
            <input type="text" id="address" name="address"><br><br>

            <label for="state">State:</label><br>
            <input type="text" id="state" name="state" maxlength="2"><br><br>

            <label for="city">City:</label><br>
            <input type="text" id="city" name="city"><br><br>

            <label for="zip_code">Zip Code:</label><br>
            <input type="text" id="zip_code" name="zip_code"><br><br>

            <label for="insurance_provider">Insurance Provider:</label><br>
            <input type="text" id="insurance_provider" name="insurance_provider"><br><br>

            <label for="current_patient">Current Patient:</label>
            <select id="current_patient" name="current_patient">
                <option value="1">Yes</option>
                <option value="0">No</option>
            </select><br><br>

            <button type="submit">Add Patient</button>
        </form>
    
        <!-- Delete Patient Form -->
        <form class="welcome" action="/delete_patient" method="post">
            <h2>Delete Patient</h2>

            <label for="patient_id">Enter Patient Email to Delete:</label><br>
            <input type="text" id="patient_id" name="patient_id" required><br><br>

            <button type="submit">Delete Patient</button>
        </form>
    </div>
        <!-- All Patients Table -->
        <h2>All Patients</h2>
        <table border="1" cellpadding="6">
            <thead>
                <tr>
                    <th>Patient ID</th>
                    <th>First Name</th>
                    <th>Last Name</th>
                    <th>DOB</th>
                    <th>Gender</th>
                    <th>Phone</th>
                    <th>Email</th>
                    <th>Address</th>
                    <th>State</th>
                    <th>City</th>
                    <th>Zip Code</th>
                    <th>Insurance Provider</th>
                    <th>Current Patient</th>
                </tr>
            </thead>
            <tbody id="patientTable"></tbody>
        </table>

        <!-- Fetch Patients -->
        <script>
            fetch('/patients')
                .then(response => response.json())
                .then(data => {
                    const table = document.getElementById("patientTable");
                    table.innerHTML = "";

                    data.forEach(p => {
                        const row = table.insertRow();
                        row.insertCell(0).innerText = p.patient_id;
                        row.insertCell(1).innerText = p.first_name;
                        row.insertCell(2).innerText = p.last_name;
                        row.insertCell(3).innerText = p.date_of_birth;
                        row.insertCell(4).innerText = p.gender;
                        row.insertCell(5).innerText = p.phone_number || "";
                        row.insertCell(6).innerText = p.email || "";
                        row.insertCell(7).innerText = p.address  || "";
                        row.insertCell(8).innerText = p.state || "";
                        row.insertCell(9).innerText = p.city || "";
                        row.insertCell(10).innerText = p.zip_code || "";
                        row.insertCell(11).innerText = p.insurance_provider || "";
                        row.insertCell(12).innerText = p.current_patient ? "Yes" : "No";
                    });
                })
                .catch(err => console.error("Error loading patients:", err));
        </script>
</body>
</html>
