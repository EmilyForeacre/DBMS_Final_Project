<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Medicine Management</title>
</head>
<body>
    <a href="http://localhost:3000/dashboard">Back to Dashboard</a>
    <h1>Medicine Management</h1>

    <!-- Add Medicine Form -->
    <h2>Add Medicine</h2>
    <form action="/add_medicine" method="post">
        <label for="medicine_name">Medicine Name:</label><br>
        <input type="text" id="medicine_name" name="medicine_name" required><br><br>

        <label for="generic_name">Generic Name:</label><br>
        <input type="text" id="generic_name" name="generic_name"><br><br>

        <label for="dosage_type">Dosage Type:</label><br>
        <input type="text" id="dosage_type" name="dosage_type" required><br><br>

        <label for="strength">Strength:</label><br>
        <input type="text" id="strength" name="strength" required><br><br>

        <label for="manufacturer">Manufacturer:</label><br>
        <input type="text" id="manufacturer" name="manufacturer"><br><br>

        <label for="needs_prescription">Needs Prescription:</label>
        <select id="needs_prescription" name="needs_prescription">
            <option value="1">Yes</option>
            <option value="0">No</option>
        </select><br><br>

        <label for="instructions">Instructions:</label><br>
        <textarea id="instructions" name="instructions" rows="2" cols="50"></textarea><br><br>

        <label for="side_effects">Side Effects:</label><br>
        <textarea id="side_effects" name="side_effects" rows="2" cols="50"></textarea><br><br>

        <label for="currently_used">Currently Used:</label>
        <select id="currently_used" name="currently_used">
            <option value="1">Yes</option>
            <option value="0">No</option>
        </select><br><br>

        <button type="submit">Add Medicine</button>
    </form>

    <!-- Delete Medicine Form -->
    <h2>Delete Medicine</h2>
    <form action="/delete_medicine" method="post">
        <label for="medicine_name">Enter Medicine Name to Delete:</label><br>
        <input type="text" id="medicine_name" name="medicine_name" required><br><br>

        <button type="submit">Delete Medicine</button>
    </form>

    <!-- All Medicines Table -->
    <h2>All Medicines</h2>
    <table border="1" cellpadding="6">
        <thead>
            <tr>
                <th>ID</th>
                <th>Medicine Name</th>
                <th>Generic Name</th>
                <th>Dosage Type</th>
                <th>Strength</th>
                <th>Manufacturer</th>
                <th>Needs Prescription</th>
                <th>Instructions</th>
                <th>Side Effects</th>
                <th>Currently Used</th>
            </tr>
        </thead>
        <tbody id="medicineTable"></tbody>
    </table>

    <!-- Fetch Medicines -->
    <script>
        fetch('/medicines')
            .then(response => response.json())
            .then(data => {
                const table = document.getElementById("medicineTable");
                table.innerHTML = "";

                data.forEach(m => {
                    const row = table.insertRow();
                    row.insertCell(0).innerText = m.medicine_id;
                    row.insertCell(1).innerText = m.medicine_name;
                    row.insertCell(2).innerText = m.generic_name || "";
                    row.insertCell(3).innerText = m.dosage_type;
                    row.insertCell(4).innerText = m.strength;
                    row.insertCell(5).innerText = m.manufacturer || "";
                    row.insertCell(6).innerText = m.needs_prescription ? "Yes" : "No";
                    row.insertCell(7).innerText = m.instructions || "";
                    row.insertCell(8).innerText = m.side_effects || "";
                    row.insertCell(9).innerText = m.currently_used ? "Yes" : "No";
                });
            })
            .catch(err => console.error("Error loading medicines:", err));
    </script>
</body>
</html>